{"version":3,"file":"/Modules/FlashSale/Assets/admin/js/flashsale.js","mappings":"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","sources":["webpack://fleetcart/./Modules/FlashSale/Resources/assets/admin/js/FlashSaleProduct.js","webpack://fleetcart/./Modules/FlashSale/Resources/assets/admin/js/main.js","webpack://fleetcart/./Modules/FlashSale/Resources/assets/admin/js/FlashSale.js"],"sourcesContent":["export default class {\r\n    constructor(data) {\r\n        this.productPanelHtml = this.getProductPanelHtml(data);\r\n    }\r\n\r\n    getProductPanelHtml(data) {\r\n        data.product = this.normalizeAttributes(data.product);\r\n\r\n        let template = _.template($('#flash-sale-product-template').html());\r\n\r\n        return $(template(data));\r\n    }\r\n\r\n    normalizeAttributes(product) {\r\n        if ($.isEmptyObject(product)) {\r\n            return { id: null, pivot: { campaign_end: null, price: { amount: null }, qty: null } };\r\n        }\r\n\r\n        if (! $.isEmptyObject(FleetCart.errors['flash_sale.products'])) {\r\n            return {\r\n                id: product.id,\r\n                name: product.name,\r\n                pivot: { campaign_end: product.campaign_end, price: { amount: product.price }, qty: product.qty },\r\n            };\r\n        }\r\n\r\n        return product;\r\n    }\r\n\r\n    render() {\r\n        this.attachEventListeners();\r\n\r\n        window.admin.dateTimePicker(this.productPanelHtml.find('.datetime-picker'));\r\n\r\n        return this.productPanelHtml;\r\n    }\r\n\r\n    attachEventListeners() {\r\n        this.productPanelHtml.find('.delete-product-panel').on('click', () => {\r\n            this.productPanelHtml.remove();\r\n        });\r\n    }\r\n}\r\n","import FlashSale from './FlashSale';\r\n\r\nnew FlashSale();\r\n\r\nwindow.admin.removeSubmitButtonOffsetOn(['#products']);\r\n","import FlashSaleProduct from './FlashSaleProduct';\r\n\r\nexport default class {\r\n    constructor() {\r\n        this.productCount = 0;\r\n\r\n        this.addFlashSaleProducts(FleetCart.data['flash_sale.products']);\r\n\r\n        if (this.productCount === 0) {\r\n            this.addProduct();\r\n        }\r\n\r\n        this.addFlashSaleProductsError(FleetCart.errors['flash_sale.products']);\r\n\r\n        this.attachEventListeners();\r\n        this.makeProductPanelsSortable();\r\n    }\r\n\r\n    addFlashSaleProducts(products) {\r\n        for (let attributes of products) {\r\n            this.addProduct(attributes);\r\n        }\r\n    }\r\n\r\n    addProduct(attributes = {}) {\r\n        let productTemplate = new FlashSaleProduct({ productPanelNumber: this.productCount++, product: attributes });\r\n\r\n        $('#products-wrapper').append(productTemplate.render());\r\n\r\n        window.admin.selectize();\r\n    }\r\n\r\n    addFlashSaleProductsError(errors) {\r\n        for (let key in errors) {\r\n            let parent = this.getInputFieldForKey(key).parent();\r\n\r\n            parent.addClass('has-error');\r\n            parent.append(`<span class=\"help-block\">${errors[key][0]}</span>`);\r\n        }\r\n    }\r\n\r\n    getInputFieldForKey(key) {\r\n        let keyParts = key.split('.');\r\n\r\n        // Replace all \"_\" to \"-\".\r\n        keyParts = keyParts.map(k => {\r\n            return k.split('_').join('-');\r\n        });\r\n\r\n        return $(`#${keyParts.join('-')}`);\r\n    }\r\n\r\n    attachEventListeners() {\r\n        $('.add-product').on('click', () => {\r\n            this.addProduct();\r\n        });\r\n    }\r\n\r\n    makeProductPanelsSortable() {\r\n        Sortable.create(document.getElementById('products-wrapper'), {\r\n            handle: '.drag-icon',\r\n            animation: 150,\r\n        });\r\n    }\r\n}\r\n"],"names":["_default","data","_classCallCheck","this","productPanelHtml","getProductPanelHtml","key","value","product","normalizeAttributes","template","_","$","html","isEmptyObject","id","pivot","campaign_end","price","amount","qty","FleetCart","errors","name","attachEventListeners","window","admin","dateTimePicker","find","_this","on","remove","productCount","addFlashSaleProducts","addProduct","addFlashSaleProductsError","makeProductPanelsSortable","products","_step","_iterator","_createForOfIteratorHelper","s","n","done","attributes","err","e","f","arguments","length","undefined","productTemplate","FlashSaleProduct","productPanelNumber","append","render","selectize","parent","getInputFieldForKey","addClass","concat","keyParts","split","map","k","join","Sortable","create","document","getElementById","handle","animation","removeSubmitButtonOffsetOn"],"sourceRoot":""}