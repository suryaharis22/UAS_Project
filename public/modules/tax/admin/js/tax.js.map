{"version":3,"file":"/Modules/Tax/Assets/admin/js/tax.js","mappings":"ivBACI,SAAAA,EAAYC,GAAmB,IAAXC,EAAIC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,G,4FAACG,CAAA,KAAAN,GACzBO,KAAKN,OAASA,EACdM,KAAKL,KAAOA,CAChB,C,UA0EC,O,EA1EAF,G,EAAA,EAAAQ,IAAA,OAAAC,MAED,WAKI,OAJAF,KAAKG,KAAOH,KAAKI,SAAS,CAAEV,OAAQM,KAAKN,OAAQC,KAAMK,KAAKL,OAE5DK,KAAKK,iBAEEL,KAAKG,IAChB,GAAC,CAAAF,IAAA,cAAAC,MAED,WACIF,KAAKG,KAAKG,KAAK,mBAAmBC,QAAQ,SAC9C,GAAC,CAAAN,IAAA,WAAAC,MAED,SAASM,GACL,IAAIJ,EAAWK,EAAEL,SAASM,EAAE,sBAAsBP,QAElD,OAAOO,EAAEN,EAASI,GACtB,GAAC,CAAAP,IAAA,iBAAAC,MAED,SAAeC,GAAM,IAAAQ,EAAA,KACjBX,KAAKG,KAAKG,KAAK,mBAAmBM,GAAG,UAAU,SAACC,GACxCA,EAAEC,cAAcZ,OAChBS,EAAKI,YAAYF,EAAEC,cAAcZ,MAEzC,IAEAF,KAAKG,KAAKS,GAAG,QAAS,cAAeZ,KAAI,OAC7C,GAAC,CAAAC,IAAA,cAAAC,MAED,SAAYc,GAAa,IAAAC,EAAA,KACrBjB,KAAKkB,gBAAgBC,KAAK,YAAY,GAEtC,IAAIC,EAAWpB,KAAKkB,gBAAgBG,MAEpCX,EAAEY,QAAQC,MAAM,yBAA0BP,IAAc,SAACQ,GACrDP,EAAKC,gBACAO,YAAYR,EAAKS,iBAAiBF,IAClCL,KAAK,YAAY,GAElBC,GACAH,EAAKC,gBAAgBG,IAAID,EAEjC,GACJ,GAAC,CAAAnB,IAAA,gBAAAC,MAED,WACI,IAAIyB,EAAKjB,EAAEkB,eAAe,SAADC,OAAU7B,KAAKN,OAAM,WAE9C,OAAOgB,EAAE,IAADmB,OAAKF,GACjB,GAAC,CAAA1B,IAAA,mBAAAC,MAED,SAAiBsB,GACb,OAAId,EAAEoB,cAAcN,GACTxB,KAAK+B,wBAGT/B,KAAKgC,uBAAuBR,EACvC,GAAC,CAAAvB,IAAA,wBAAAC,MAED,WAGI,OAFeO,EAAEL,SAASM,EAAE,yBAAyBP,OAE9CC,CAAS,CAAEV,OAAQM,KAAKN,QACnC,GAAC,CAAAO,IAAA,yBAAAC,MAED,SAAuBsB,GAGnB,OAFef,EAAEL,SAASM,EAAE,0BAA0BP,OAE/CC,CAAS,CAAEV,OAAQM,KAAKN,OAAQ8B,OAAAA,GAC3C,GAAC,CAAAvB,IAAA,SAAAC,MAED,SAAOW,GACHH,EAAEG,EAAEC,eAAemB,QAAQ,aAAaC,QAC5C,M,8EAACzC,CAAA,C,ouDC9E2B,IAAAA,EAAA,WAG5B,SAAAA,K,4FAAcM,CAAA,KAAAN,GACVO,KAAKmC,UAAY,EAEjBnC,KAAKoC,YAAYC,UAAU7B,KAAgB,WAEpB,IAAnBR,KAAKmC,WACLnC,KAAKsC,aAGTtC,KAAKuC,kBAAkBF,UAAUG,OAAkB,WAEnDxC,KAAKK,iBACLL,KAAKyC,UACT,C,UAqCC,O,EArCAhD,E,EAAA,EAAAQ,IAAA,cAAAC,MAED,SAAYwC,GAAO,IACOC,EADPC,EAAAC,EACEH,GAAK,IAAtB,IAAAE,EAAAE,MAAAH,EAAAC,EAAAG,KAAAC,MAAwB,KAAfrD,EAAIgD,EAAAzC,MACTF,KAAKsC,WAAW3C,EACpB,CAAC,OAAAsD,GAAAL,EAAA/B,EAAAoC,EAAA,SAAAL,EAAAM,GAAA,CACL,GAAC,CAAAjD,IAAA,aAAAC,MAED,WAAsB,IAAXP,EAAIC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACXuD,EAAW,IAAIC,EAAQpD,KAAKmC,YAAaxC,GAE7Ce,EAAE,cAAc2C,OAAOF,EAAShD,QAEhCgD,EAASG,cAETC,OAAOC,MAAMC,SACjB,GAAC,CAAAxD,IAAA,oBAAAC,MAED,SAAkBsC,GACd,IAAK,IAAIvC,KAAOuC,EAAQ,CACpB,IAAIb,EAAKjB,EAAEkB,eAAe3B,GACtByD,EAAShD,EAAE,IAADmB,OAAKF,IAAM+B,SAEzBA,EAAOC,SAAS,aAChBD,EAAOL,OAAO,4BAADxB,OAA6BW,EAAOvC,GAAK,GAAE,WAC5D,CACJ,GAAC,CAAAA,IAAA,iBAAAC,MAED,WAAiB,IAAAS,EAAA,KACbD,EAAE,iBAAiBE,GAAG,SAAS,kBAAMD,EAAK2B,YAAY,GAC1D,GAAC,CAAArC,IAAA,WAAAC,MAED,WACI0D,SAASC,OAAOC,SAASC,eAAe,aAAc,CAClDC,OAAQ,aACRC,UAAW,KAEnB,I,iFAACxE,CAAA,CArD2B,GCEhC8D,OAAOC,MAAMU,2BAA2B,UAExC,IAAIC,C","sources":["webpack://fleetcart/./Modules/Tax/Resources/assets/admin/js/TaxRate.js","webpack://fleetcart/./Modules/Tax/Resources/assets/admin/js/TaxRates.js","webpack://fleetcart/./Modules/Tax/Resources/assets/admin/js/main.js"],"sourcesContent":["export default class {\r\n    constructor(rateId, rate = {}) {\r\n        this.rateId = rateId;\r\n        this.rate = rate;\r\n    }\r\n\r\n    html() {\r\n        this.html = this.template({ rateId: this.rateId, rate: this.rate });\r\n\r\n        this.eventListeners();\r\n\r\n        return this.html;\r\n    }\r\n\r\n    updateState() {\r\n        this.html.find('.country select').trigger('change');\r\n    }\r\n\r\n    template(data) {\r\n        let template = _.template($('#tax-rate-template').html());\r\n\r\n        return $(template(data));\r\n    }\r\n\r\n    eventListeners(html) {\r\n        this.html.find('.country select').on('change', (e) => {\r\n            if (e.currentTarget.value) {\r\n                this.changeState(e.currentTarget.value);\r\n            }\r\n        });\r\n\r\n        this.html.on('click', '.delete-row', this.delete);\r\n    }\r\n\r\n    changeState(countryCode) {\r\n        this.getStateField().prop('disabled', true);\r\n\r\n        let oldState = this.getStateField().val();\r\n\r\n        $.getJSON(route('countries.states.index', countryCode), (states) => {\r\n            this.getStateField()\r\n                .replaceWith(this.getStateTemplate(states))\r\n                .prop('disabled', false);\r\n\r\n            if (oldState) {\r\n                this.getStateField().val(oldState);\r\n            }\r\n        });\r\n    }\r\n\r\n    getStateField() {\r\n        let id = $.escapeSelector(`rates.${this.rateId}.state`);\r\n\r\n        return $(`#${id}`);\r\n    }\r\n\r\n    getStateTemplate(states) {\r\n        if ($.isEmptyObject(states)) {\r\n            return this.getInputStateTemplate();\r\n        }\r\n\r\n        return this.getSelectStateTemplate(states);\r\n    }\r\n\r\n    getInputStateTemplate() {\r\n        let template = _.template($('#state-input-template').html());\r\n\r\n        return template({ rateId: this.rateId });\r\n    }\r\n\r\n    getSelectStateTemplate(states) {\r\n        let template = _.template($('#state-select-template').html());\r\n\r\n        return template({ rateId: this.rateId, states });\r\n    }\r\n\r\n    delete(e) {\r\n        $(e.currentTarget).closest('.tax-rate').remove();\r\n    }\r\n}\r\n","import TaxRate from \"./TaxRate\";\r\n\r\nexport default class {\r\n    constructor() {\r\n        this.rateCount = 0;\r\n\r\n        this.addTaxRates(FleetCart.data['tax_rates']);\r\n\r\n        if (this.rateCount === 0) {\r\n            this.addTaxRate();\r\n        }\r\n\r\n        this.addTaxRatesErrors(FleetCart.errors['tax_rates']);\r\n\r\n        this.eventListeners();\r\n        this.sortable();\r\n    }\r\n\r\n    addTaxRates(rates) {\r\n        for (let rate of rates) {\r\n            this.addTaxRate(rate)\r\n        }\r\n    }\r\n\r\n    addTaxRate(rate = {}) {\r\n        let textRate = new TaxRate(this.rateCount++, rate);\r\n\r\n        $('#tax-rates').append(textRate.html());\r\n\r\n        textRate.updateState();\r\n\r\n        window.admin.tooltip();\r\n    }\r\n\r\n    addTaxRatesErrors(errors) {\r\n        for (let key in errors) {\r\n            let id = $.escapeSelector(key);\r\n            let parent = $(`#${id}`).parent();\r\n\r\n            parent.addClass('has-error');\r\n            parent.append(`<span class=\"help-block\">${errors[key][0]}</span>`);\r\n        }\r\n    }\r\n\r\n    eventListeners() {\r\n        $('#add-new-rate').on('click', () => this.addTaxRate());\r\n    }\r\n\r\n    sortable() {\r\n        Sortable.create(document.getElementById('tax-rates'), {\r\n            handle: '.drag-icon',\r\n            animation: 150,\r\n        });\r\n    }\r\n}\r\n","import TaxRates from './TaxRates';\r\n\r\nwindow.admin.removeSubmitButtonOffsetOn('#rates');\r\n\r\nnew TaxRates();\r\n"],"names":["_default","rateId","rate","arguments","length","undefined","_classCallCheck","this","key","value","html","template","eventListeners","find","trigger","data","_","$","_this","on","e","currentTarget","changeState","countryCode","_this2","getStateField","prop","oldState","val","getJSON","route","states","replaceWith","getStateTemplate","id","escapeSelector","concat","isEmptyObject","getInputStateTemplate","getSelectStateTemplate","closest","remove","rateCount","addTaxRates","FleetCart","addTaxRate","addTaxRatesErrors","errors","sortable","rates","_step","_iterator","_createForOfIteratorHelper","s","n","done","err","f","textRate","TaxRate","append","updateState","window","admin","tooltip","parent","addClass","Sortable","create","document","getElementById","handle","animation","removeSubmitButtonOffsetOn","TaxRates"],"sourceRoot":""}